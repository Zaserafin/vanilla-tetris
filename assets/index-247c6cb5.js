(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))f(o);new MutationObserver(o=>{for(const d of o)if(d.type==="childList")for(const R of d.addedNodes)R.tagName==="LINK"&&R.rel==="modulepreload"&&f(R)}).observe(document,{childList:!0,subtree:!0});function c(o){const d={};return o.integrity&&(d.integrity=o.integrity),o.referrerPolicy&&(d.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?d.credentials="include":o.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function f(o){if(o.ep)return;o.ep=!0;const d=c(o);fetch(o.href,d)}})();class Qt{constructor(s=60,c=60){this.isRunning=!1,this.gameTickRate=s,this.lastGameTick=0,this.lastRender=0,this.targetFPS=c,this.frameDuration=1e3/this.targetFPS,this.gameLoop=this.gameLoop.bind(this),this.renderLoop=this.renderLoop.bind(this)}start(){this.isRunning||(this.isRunning=!0,this.gameLoop(),this.renderLoop())}stop(){this.isRunning=!1}update(){}render(){}gameLoop(){if(this.isRunning){const s=performance.now();s-this.lastGameTick>=1e3/this.gameTickRate&&(this.update(),this.lastGameTick=s),requestAnimationFrame(this.gameLoop)}}renderLoop(){if(this.isRunning){const s=performance.now();s-this.lastRender>=this.frameDuration&&(this.render(),this.lastRender=s),requestAnimationFrame(this.renderLoop)}}}const g={playerScore:0,tetrisCount:0,highScore:0,gameOver:!1};class ht{constructor(s,c,f,o="white"){if(!s)throw new Error("Cannot initialize renderer without a proper canvas");this.canvas=s,this.context=this.canvas.getContext("2d"),this.resize({width:c,height:f}),this.setBackgroundColor(o)}setBackgroundColor(s){this.canvas.style.backgroundColor=s}clear(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)}drawRect(s,c,f,o,d){this.context.fillStyle=d,this.context.fillRect(s,c,f,o)}drawText(s,c,f,o,d){this.context.fillStyle=d,this.context.font=o,this.context.fillText(s,c,f)}drawImage(s,c,f,o,d){this.context.drawImage(s,c,f,o,d)}getCanvasInfo(){return{width:this.canvas.width,height:this.canvas.height,backgroundColor:this.canvas.style.backgroundColor}}resize({width:s=null,height:c=null}){s&&(this.canvas.width=s),c&&(this.canvas.height=c)}}function De(h){return Object.create(h[Math.floor(Math.random()*h.length)])}function Kt(h,s){let c=[];for(let f=0;f<s;f++){const o=[];for(let d=0;d<h;d++)o.push(0);c.push(o)}return c}function B(h,s,c,f,o="down"){let d={x:Math.trunc(s.x),y:Math.trunc(s.y)};for(let R=0;R<s.template.length;R++)for(let z=0;z<s.template[R].length;z++){if(s.template[R][z]===0)continue;let _=z+d.x,S=R+d.y;if(o==="down"&&(S+1>=f||h[S+1][_]!==0)||o==="right"&&(_+1>=c||h[S][_+1]!==0)||o==="left"&&(_-1<0||h[S][_-1]!==0))return!1}return!0}function $t(h){return{x:Math.trunc(h.x),y:Math.trunc(h.y)}}const C={transparent:"transparent",red:"red",green:"green",blue:"blue",yellow:"yellow",orange:"orange",violet:"violet",coral:"coral",lightgreen:"lightgreen",cyan:"cyan",darkGrey:"#4f4f4f",lineColor:"#ffffff09",solidColor:"lightcoral"},qe=[{id:"i",x:4,y:0,color:C.cyan,template:[[1,1,1,1]]},{id:"j",x:4,y:0,color:C.blue,template:[[1,1,1],[0,0,1]]},{id:"l",x:4,y:0,color:C.orange,template:[[1,1,1],[1,0,0]]},{id:"o",x:4,y:0,color:C.yellow,template:[[1,1],[1,1]]},{id:"s",x:4,y:0,color:C.lightgreen,template:[[0,1,1],[1,1,0]]},{id:"t",x:4,y:0,color:C.violet,template:[[0,1,0],[1,1,1]]},{id:"z",x:4,y:0,color:C.coral,template:[[1,1,0],[0,1,1]]}],Le={single:100,double:200,triple:300,tetris:800,doubleTetris:1200},l={fullscreentBbuttonId:"fullscreen-button",mainCanvasId:"game-canvas",pieceCanvasId:"piece-canvas",scoreElementId:"score",tetrisElementId:"tetris",highScoreElementId:"highscore",soundEnabled:!0,squareSize:30,backgroundColor:"#4f4f4f",lineColor:"#ffffff09",lineThickness:2,solidColor:"lightcoral",tickRate:4,frameRate:30,canvasHeight:600,canvasWidth:300,boardOffset:4};class er extends Qt{constructor(){super(l.tickRate,l.frameRate),this.gameCanvas=document.getElementById(l.mainCanvasId),this.pieceCanvas=document.getElementById(l.pieceCanvasId),this.scoreElement=document.getElementById(l.scoreElementId),this.tetrisElement=document.getElementById(l.tetrisElementId),this.highScoreElement=document.getElementById(l.highScoreElementId),this.gameRenderer=new ht(this.gameCanvas,l.canvasWidth,l.canvasHeight,C.darkGrey),this.pieceRenderer=new ht(this.pieceCanvas,0,0,C.transparent),this.squareCountX=this.gameRenderer.getCanvasInfo().width/l.squareSize,this.squareCountY=this.gameRenderer.getCanvasInfo().height/l.squareSize,this.board=Kt(this.squareCountX,this.squareCountY+l.boardOffset),g.highScore=window.localStorage.getItem(l.highScoreElementId)||0,this.updateScores()}start(){this.gameCanvas.style.pointerEvents="all",this.currentPiece=De(qe),this.nextPiece=De(qe),this.renderNextPiece(),super.start()}handleRotationMovement(){B(this.board,this.currentPiece,this.squareCountX,this.squareCountY,"left")&&B(this.board,this.currentPiece,this.squareCountX,this.squareCountY,"right")&&B(this.board,this.currentPiece,this.squareCountX,this.squareCountY,"down")&&(this.currentPiece.template=this.currentPiece.template[0].map((s,c)=>this.currentPiece.template.map(f=>f[c]).reverse()))}handleLeftMovement(){B(this.board,this.currentPiece,this.squareCountX,this.squareCountY,"left")&&this.currentPiece.x--}handleRightMovement(){B(this.board,this.currentPiece,this.squareCountX,this.squareCountY,"right")&&this.currentPiece.x++}checkGameOver(){return this.board[0].some(s=>s!==0)}clearCompleteRows(){let s=0;for(let c=0;c<this.board.length;c++)this.board[c].every(f=>f!==0)&&(s++,this.board.splice(c,1),this.board.unshift(Array(this.squareCountX).fill(0)));s>=4?(g.previousTetris=!0,g.playerScore+=g.previousTetris?Le.doubleTetris:Le.tetris,g.tetrisCount++):(g.previousTetris=!1,g.playerScore+=s*Le.single),this.updateScores()}updateScores(){this.scoreElement.innerText=`Score: ${g.playerScore}`,this.tetrisElement.innerText=`Tetris: ${g.tetrisCount}`,this.highScoreElement.innerText=`Highscore: ${g.highScore}`}update(){if(!g.gameOver)if(B(this.board,this.currentPiece,this.squareCountX,this.squareCountY))this.currentPiece.y++;else{let s=$t({x:this.currentPiece.x,y:this.currentPiece.y});for(let c=0;c<this.currentPiece.template.length;c++)for(let f=0;f<this.currentPiece.template[c].length;f++){if(this.currentPiece.template[c][f]===0)continue;let o=f+s.x,d=c+s.y;this.board[d][o]=1}this.currentPiece.y=0,this.currentPiece.x=Math.trunc(this.squareCountX/2),this.currentPiece=this.nextPiece,this.nextPiece=De(qe),this.clearCompleteRows(),this.renderNextPiece(),this.checkGameOver()&&(g.gameOver=!0,g.playerScore>g.highScore&&(g.highScore=g.playerScore,window.localStorage.setItem("highscore",g.highScore)))}}renderBackground(){for(let s=0;s<this.squareCountX;s++)this.gameRenderer.drawRect(l.squareSize*s-l.lineThickness,0,l.lineThickness,this.gameRenderer.getCanvasInfo().height,C.lineColor);for(let s=0;s<this.squareCountY;s++)this.gameRenderer.drawRect(0,l.squareSize*s-l.lineThickness,this.gameRenderer.getCanvasInfo().width,l.lineThickness,C.lineColor)}renderBoard(){for(let s=0;s<this.board.length;s++){const c=this.board[s];for(let f=0;f<c.length;f++)this.board[s][f]!==0&&this.gameRenderer.drawRect(f*l.squareSize,s*l.squareSize,l.squareSize-l.lineThickness,l.squareSize-l.lineThickness,C.solidColor)}}renderCurrentPiece(){for(let s=0;s<this.currentPiece.template.length;s++)for(let c=0;c<this.currentPiece.template[s].length;c++)this.currentPiece.template[s][c]!==0&&this.gameRenderer.drawRect((this.currentPiece.x+c)*l.squareSize,(this.currentPiece.y+s)*l.squareSize,l.squareSize-l.lineThickness,l.squareSize-l.lineThickness,this.currentPiece.color)}renderNextPiece(){this.pieceRenderer.resize({width:this.nextPiece.template[0].length*l.squareSize,height:l.squareSize*2});for(let s=0;s<this.nextPiece.template.length;s++)for(let c=0;c<this.nextPiece.template[s].length;c++)this.nextPiece.template[s][c]!==0&&this.pieceRenderer.drawRect(c*l.squareSize,s*l.squareSize,l.squareSize-l.lineThickness,l.squareSize-l.lineThickness,this.nextPiece.color)}renderGameOver(){this.gameRenderer.setBackgroundColor(C.solidColor)}render(){if(this.gameRenderer.clear(),g.gameOver){this.renderGameOver();return}this.renderBackground(),this.renderBoard(),this.renderCurrentPiece()}}function tr(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var ut={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(h){(function(s,c,f,o){var d=["","webkit","Moz","MS","ms","o"],R=c.createElement("div"),z="function",_=Math.round,S=Math.abs,Ee=Date.now;function ye(e,t,r){return setTimeout(Ie(e,r),t)}function V(e,t,r){return Array.isArray(e)?(D(e,r[t],r),!0):!1}function D(e,t,r){var i;if(e)if(e.forEach)e.forEach(t,r);else if(e.length!==o)for(i=0;i<e.length;)t.call(r,e[i],i,e),i++;else for(i in e)e.hasOwnProperty(i)&&t.call(r,e[i],i,e)}function Ue(e,t,r){var i="DEPRECATED METHOD: "+t+`
`+r+` AT 
`;return function(){var n=new Error("get-stack-trace"),a=n&&n.stack?n.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",u=s.console&&(s.console.warn||s.console.log);return u&&u.call(s.console,i,a),e.apply(this,arguments)}}var x;typeof Object.assign!="function"?x=function(t){if(t===o||t===null)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(n!==o&&n!==null)for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a])}return r}:x=Object.assign;var Xe=Ue(function(t,r,i){for(var n=Object.keys(r),a=0;a<n.length;)(!i||i&&t[n[a]]===o)&&(t[n[a]]=r[n[a]]),a++;return t},"extend","Use `assign`."),pt=Ue(function(t,r){return Xe(t,r,!0)},"merge","Use `assign`.");function P(e,t,r){var i=t.prototype,n;n=e.prototype=Object.create(i),n.constructor=e,n._super=i,r&&x(n,r)}function Ie(e,t){return function(){return e.apply(t,arguments)}}function Pe(e,t){return typeof e==z?e.apply(t&&t[0]||o,t):e}function Ye(e,t){return e===o?t:e}function ie(e,t,r){D(se(t),function(i){e.addEventListener(i,r,!1)})}function ne(e,t,r){D(se(t),function(i){e.removeEventListener(i,r,!1)})}function ke(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function Y(e,t){return e.indexOf(t)>-1}function se(e){return e.trim().split(/\s+/g)}function W(e,t,r){if(e.indexOf&&!r)return e.indexOf(t);for(var i=0;i<e.length;){if(r&&e[i][r]==t||!r&&e[i]===t)return i;i++}return-1}function ae(e){return Array.prototype.slice.call(e,0)}function Fe(e,t,r){for(var i=[],n=[],a=0;a<e.length;){var u=t?e[a][t]:e[a];W(n,u)<0&&i.push(e[a]),n[a]=u,a++}return r&&(t?i=i.sort(function(T,y){return T[t]>y[t]}):i=i.sort()),i}function oe(e,t){for(var r,i,n=t[0].toUpperCase()+t.slice(1),a=0;a<d.length;){if(r=d[a],i=r?r+n:t,i in e)return i;a++}return o}var mt=1;function gt(){return mt++}function He(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||s}var Tt=/mobile|tablet|ip(ad|hone|od)|android/i,ze="ontouchstart"in s,Et=oe(s,"PointerEvent")!==o,yt=ze&&Tt.test(navigator.userAgent),Z="touch",It="pen",Ce="mouse",Pt="kinect",Ct=25,E=1,k=2,v=4,I=8,ce=1,j=2,J=4,Q=8,K=16,M=j|J,F=Q|K,Ve=M|F,We=["x","y"],he=["clientX","clientY"];function O(e,t){var r=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(i){Pe(e.options.enable,[e])&&r.handler(i)},this.init()}O.prototype={handler:function(){},init:function(){this.evEl&&ie(this.element,this.evEl,this.domHandler),this.evTarget&&ie(this.target,this.evTarget,this.domHandler),this.evWin&&ie(He(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&ne(this.element,this.evEl,this.domHandler),this.evTarget&&ne(this.target,this.evTarget,this.domHandler),this.evWin&&ne(He(this.element),this.evWin,this.domHandler)}};function _t(e){var t,r=e.options.inputClass;return r?t=r:Et?t=Se:yt?t=fe:ze?t=Oe:t=ue,new t(e,St)}function St(e,t,r){var i=r.pointers.length,n=r.changedPointers.length,a=t&E&&i-n===0,u=t&(v|I)&&i-n===0;r.isFirst=!!a,r.isFinal=!!u,a&&(e.session={}),r.eventType=t,Ot(e,r),e.emit("hammer.input",r),e.recognize(r),e.session.prevInput=r}function Ot(e,t){var r=e.session,i=t.pointers,n=i.length;r.firstInput||(r.firstInput=Ge(t)),n>1&&!r.firstMultiple?r.firstMultiple=Ge(t):n===1&&(r.firstMultiple=!1);var a=r.firstInput,u=r.firstMultiple,m=u?u.center:a.center,T=t.center=Be(i);t.timeStamp=Ee(),t.deltaTime=t.timeStamp-a.timeStamp,t.angle=_e(m,T),t.distance=le(m,T),Nt(r,t),t.offsetDirection=je(t.deltaX,t.deltaY);var y=Ze(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=y.x,t.overallVelocityY=y.y,t.overallVelocity=S(y.x)>S(y.y)?y.x:y.y,t.scale=u?xt(u.pointers,i):1,t.rotation=u?At(u.pointers,i):0,t.maxPointers=r.prevInput?t.pointers.length>r.prevInput.maxPointers?t.pointers.length:r.prevInput.maxPointers:t.pointers.length,Rt(r,t);var w=e.element;ke(t.srcEvent.target,w)&&(w=t.srcEvent.target),t.target=w}function Nt(e,t){var r=t.center,i=e.offsetDelta||{},n=e.prevDelta||{},a=e.prevInput||{};(t.eventType===E||a.eventType===v)&&(n=e.prevDelta={x:a.deltaX||0,y:a.deltaY||0},i=e.offsetDelta={x:r.x,y:r.y}),t.deltaX=n.x+(r.x-i.x),t.deltaY=n.y+(r.y-i.y)}function Rt(e,t){var r=e.lastInterval||t,i=t.timeStamp-r.timeStamp,n,a,u,m;if(t.eventType!=I&&(i>Ct||r.velocity===o)){var T=t.deltaX-r.deltaX,y=t.deltaY-r.deltaY,w=Ze(i,T,y);a=w.x,u=w.y,n=S(w.x)>S(w.y)?w.x:w.y,m=je(T,y),e.lastInterval=t}else n=r.velocity,a=r.velocityX,u=r.velocityY,m=r.direction;t.velocity=n,t.velocityX=a,t.velocityY=u,t.direction=m}function Ge(e){for(var t=[],r=0;r<e.pointers.length;)t[r]={clientX:_(e.pointers[r].clientX),clientY:_(e.pointers[r].clientY)},r++;return{timeStamp:Ee(),pointers:t,center:Be(t),deltaX:e.deltaX,deltaY:e.deltaY}}function Be(e){var t=e.length;if(t===1)return{x:_(e[0].clientX),y:_(e[0].clientY)};for(var r=0,i=0,n=0;n<t;)r+=e[n].clientX,i+=e[n].clientY,n++;return{x:_(r/t),y:_(i/t)}}function Ze(e,t,r){return{x:t/e||0,y:r/e||0}}function je(e,t){return e===t?ce:S(e)>=S(t)?e<0?j:J:t<0?Q:K}function le(e,t,r){r||(r=We);var i=t[r[0]]-e[r[0]],n=t[r[1]]-e[r[1]];return Math.sqrt(i*i+n*n)}function _e(e,t,r){r||(r=We);var i=t[r[0]]-e[r[0]],n=t[r[1]]-e[r[1]];return Math.atan2(n,i)*180/Math.PI}function At(e,t){return _e(t[1],t[0],he)+_e(e[1],e[0],he)}function xt(e,t){return le(t[0],t[1],he)/le(e[0],e[1],he)}var Mt={mousedown:E,mousemove:k,mouseup:v},bt="mousedown",wt="mousemove mouseup";function ue(){this.evEl=bt,this.evWin=wt,this.pressed=!1,O.apply(this,arguments)}P(ue,O,{handler:function(t){var r=Mt[t.type];r&E&&t.button===0&&(this.pressed=!0),r&k&&t.which!==1&&(r=v),this.pressed&&(r&v&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[t],changedPointers:[t],pointerType:Ce,srcEvent:t}))}});var Dt={pointerdown:E,pointermove:k,pointerup:v,pointercancel:I,pointerout:I},qt={2:Z,3:It,4:Ce,5:Pt},Je="pointerdown",Qe="pointermove pointerup pointercancel";s.MSPointerEvent&&!s.PointerEvent&&(Je="MSPointerDown",Qe="MSPointerMove MSPointerUp MSPointerCancel");function Se(){this.evEl=Je,this.evWin=Qe,O.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}P(Se,O,{handler:function(t){var r=this.store,i=!1,n=t.type.toLowerCase().replace("ms",""),a=Dt[n],u=qt[t.pointerType]||t.pointerType,m=u==Z,T=W(r,t.pointerId,"pointerId");a&E&&(t.button===0||m)?T<0&&(r.push(t),T=r.length-1):a&(v|I)&&(i=!0),!(T<0)&&(r[T]=t,this.callback(this.manager,a,{pointers:r,changedPointers:[t],pointerType:u,srcEvent:t}),i&&r.splice(T,1))}});var Lt={touchstart:E,touchmove:k,touchend:v,touchcancel:I},Ut="touchstart",Xt="touchstart touchmove touchend touchcancel";function Ke(){this.evTarget=Ut,this.evWin=Xt,this.started=!1,O.apply(this,arguments)}P(Ke,O,{handler:function(t){var r=Lt[t.type];if(r===E&&(this.started=!0),!!this.started){var i=Yt.call(this,t,r);r&(v|I)&&i[0].length-i[1].length===0&&(this.started=!1),this.callback(this.manager,r,{pointers:i[0],changedPointers:i[1],pointerType:Z,srcEvent:t})}}});function Yt(e,t){var r=ae(e.touches),i=ae(e.changedTouches);return t&(v|I)&&(r=Fe(r.concat(i),"identifier",!0)),[r,i]}var kt={touchstart:E,touchmove:k,touchend:v,touchcancel:I},Ft="touchstart touchmove touchend touchcancel";function fe(){this.evTarget=Ft,this.targetIds={},O.apply(this,arguments)}P(fe,O,{handler:function(t){var r=kt[t.type],i=Ht.call(this,t,r);i&&this.callback(this.manager,r,{pointers:i[0],changedPointers:i[1],pointerType:Z,srcEvent:t})}});function Ht(e,t){var r=ae(e.touches),i=this.targetIds;if(t&(E|k)&&r.length===1)return i[r[0].identifier]=!0,[r,r];var n,a,u=ae(e.changedTouches),m=[],T=this.target;if(a=r.filter(function(y){return ke(y.target,T)}),t===E)for(n=0;n<a.length;)i[a[n].identifier]=!0,n++;for(n=0;n<u.length;)i[u[n].identifier]&&m.push(u[n]),t&(v|I)&&delete i[u[n].identifier],n++;if(m.length)return[Fe(a.concat(m),"identifier",!0),m]}var zt=2500,$e=25;function Oe(){O.apply(this,arguments);var e=Ie(this.handler,this);this.touch=new fe(this.manager,e),this.mouse=new ue(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}P(Oe,O,{handler:function(t,r,i){var n=i.pointerType==Z,a=i.pointerType==Ce;if(!(a&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(n)Vt.call(this,r,i);else if(a&&Wt.call(this,i))return;this.callback(t,r,i)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Vt(e,t){e&E?(this.primaryTouch=t.changedPointers[0].identifier,et.call(this,t)):e&(v|I)&&et.call(this,t)}function et(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var r={x:t.clientX,y:t.clientY};this.lastTouches.push(r);var i=this.lastTouches,n=function(){var a=i.indexOf(r);a>-1&&i.splice(a,1)};setTimeout(n,zt)}}function Wt(e){for(var t=e.srcEvent.clientX,r=e.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var n=this.lastTouches[i],a=Math.abs(t-n.x),u=Math.abs(r-n.y);if(a<=$e&&u<=$e)return!0}return!1}var tt=oe(R.style,"touchAction"),rt=tt!==o,it="compute",nt="auto",Ne="manipulation",H="none",$="pan-x",ee="pan-y",de=Bt();function Re(e,t){this.manager=e,this.set(t)}Re.prototype={set:function(e){e==it&&(e=this.compute()),rt&&this.manager.element.style&&de[e]&&(this.manager.element.style[tt]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return D(this.manager.recognizers,function(t){Pe(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),Gt(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,r=e.offsetDirection;if(this.manager.session.prevented){t.preventDefault();return}var i=this.actions,n=Y(i,H)&&!de[H],a=Y(i,ee)&&!de[ee],u=Y(i,$)&&!de[$];if(n){var m=e.pointers.length===1,T=e.distance<2,y=e.deltaTime<250;if(m&&T&&y)return}if(!(u&&a)&&(n||a&&r&M||u&&r&F))return this.preventSrc(t)},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};function Gt(e){if(Y(e,H))return H;var t=Y(e,$),r=Y(e,ee);return t&&r?H:t||r?t?$:ee:Y(e,Ne)?Ne:nt}function Bt(){if(!rt)return!1;var e={},t=s.CSS&&s.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(r){e[r]=t?s.CSS.supports("touch-action",r):!0}),e}var ve=1,N=2,G=4,X=8,q=X,te=16,b=32;function L(e){this.options=x({},this.defaults,e||{}),this.id=gt(),this.manager=null,this.options.enable=Ye(this.options.enable,!0),this.state=ve,this.simultaneous={},this.requireFail=[]}L.prototype={defaults:{},set:function(e){return x(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(V(e,"recognizeWith",this))return this;var t=this.simultaneous;return e=pe(e,this),t[e.id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return V(e,"dropRecognizeWith",this)?this:(e=pe(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(V(e,"requireFailure",this))return this;var t=this.requireFail;return e=pe(e,this),W(t,e)===-1&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(V(e,"dropRequireFailure",this))return this;e=pe(e,this);var t=W(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,r=this.state;function i(n){t.manager.emit(n,e)}r<X&&i(t.options.event+st(r)),i(t.options.event),e.additionalEvent&&i(e.additionalEvent),r>=X&&i(t.options.event+st(r))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=b},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(b|ve)))return!1;e++}return!0},recognize:function(e){var t=x({},e);if(!Pe(this.options.enable,[this,t])){this.reset(),this.state=b;return}this.state&(q|te|b)&&(this.state=ve),this.state=this.process(t),this.state&(N|G|X|te)&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}};function st(e){return e&te?"cancel":e&X?"end":e&G?"move":e&N?"start":""}function at(e){return e==K?"down":e==Q?"up":e==j?"left":e==J?"right":""}function pe(e,t){var r=t.manager;return r?r.get(e):e}function A(){L.apply(this,arguments)}P(A,L,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return t===0||e.pointers.length===t},process:function(e){var t=this.state,r=e.eventType,i=t&(N|G),n=this.attrTest(e);return i&&(r&I||!n)?t|te:i||n?r&v?t|X:t&N?t|G:N:b}});function me(){A.apply(this,arguments),this.pX=null,this.pY=null}P(me,A,{defaults:{event:"pan",threshold:10,pointers:1,direction:Ve},getTouchAction:function(){var e=this.options.direction,t=[];return e&M&&t.push(ee),e&F&&t.push($),t},directionTest:function(e){var t=this.options,r=!0,i=e.distance,n=e.direction,a=e.deltaX,u=e.deltaY;return n&t.direction||(t.direction&M?(n=a===0?ce:a<0?j:J,r=a!=this.pX,i=Math.abs(e.deltaX)):(n=u===0?ce:u<0?Q:K,r=u!=this.pY,i=Math.abs(e.deltaY))),e.direction=n,r&&i>t.threshold&&n&t.direction},attrTest:function(e){return A.prototype.attrTest.call(this,e)&&(this.state&N||!(this.state&N)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=at(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}});function Ae(){A.apply(this,arguments)}P(Ae,A,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[H]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&N)},emit:function(e){if(e.scale!==1){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}});function xe(){L.apply(this,arguments),this._timer=null,this._input=null}P(xe,L,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[nt]},process:function(e){var t=this.options,r=e.pointers.length===t.pointers,i=e.distance<t.threshold,n=e.deltaTime>t.time;if(this._input=e,!i||!r||e.eventType&(v|I)&&!n)this.reset();else if(e.eventType&E)this.reset(),this._timer=ye(function(){this.state=q,this.tryEmit()},t.time,this);else if(e.eventType&v)return q;return b},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===q&&(e&&e.eventType&v?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=Ee(),this.manager.emit(this.options.event,this._input)))}});function Me(){A.apply(this,arguments)}P(Me,A,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[H]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&N)}});function be(){A.apply(this,arguments)}P(be,A,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:M|F,pointers:1},getTouchAction:function(){return me.prototype.getTouchAction.call(this)},attrTest:function(e){var t=this.options.direction,r;return t&(M|F)?r=e.overallVelocity:t&M?r=e.overallVelocityX:t&F&&(r=e.overallVelocityY),this._super.attrTest.call(this,e)&&t&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&S(r)>this.options.velocity&&e.eventType&v},emit:function(e){var t=at(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}});function ge(){L.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}P(ge,L,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ne]},process:function(e){var t=this.options,r=e.pointers.length===t.pointers,i=e.distance<t.threshold,n=e.deltaTime<t.time;if(this.reset(),e.eventType&E&&this.count===0)return this.failTimeout();if(i&&n&&r){if(e.eventType!=v)return this.failTimeout();var a=this.pTime?e.timeStamp-this.pTime<t.interval:!0,u=!this.pCenter||le(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,!u||!a?this.count=1:this.count+=1,this._input=e;var m=this.count%t.taps;if(m===0)return this.hasRequireFailures()?(this._timer=ye(function(){this.state=q,this.tryEmit()},t.interval,this),N):q}return b},failTimeout:function(){return this._timer=ye(function(){this.state=b},this.options.interval,this),b},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==q&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function U(e,t){return t=t||{},t.recognizers=Ye(t.recognizers,U.defaults.preset),new we(e,t)}U.VERSION="2.0.7",U.defaults={domEvents:!1,touchAction:it,enable:!0,inputTarget:null,inputClass:null,preset:[[Me,{enable:!1}],[Ae,{enable:!1},["rotate"]],[be,{direction:M}],[me,{direction:M},["swipe"]],[ge],[ge,{event:"doubletap",taps:2},["tap"]],[xe]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Zt=1,ot=2;function we(e,t){this.options=x({},U.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=_t(this),this.touchAction=new Re(this,this.options.touchAction),ct(this,!0),D(this.options.recognizers,function(r){var i=this.add(new r[0](r[1]));r[2]&&i.recognizeWith(r[2]),r[3]&&i.requireFailure(r[3])},this)}we.prototype={set:function(e){return x(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?ot:Zt},recognize:function(e){var t=this.session;if(!t.stopped){this.touchAction.preventDefaults(e);var r,i=this.recognizers,n=t.curRecognizer;(!n||n&&n.state&q)&&(n=t.curRecognizer=null);for(var a=0;a<i.length;)r=i[a],t.stopped!==ot&&(!n||r==n||r.canRecognizeWith(n))?r.recognize(e):r.reset(),!n&&r.state&(N|G|X)&&(n=t.curRecognizer=r),a++}},get:function(e){if(e instanceof L)return e;for(var t=this.recognizers,r=0;r<t.length;r++)if(t[r].options.event==e)return t[r];return null},add:function(e){if(V(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(V(e,"remove",this))return this;if(e=this.get(e),e){var t=this.recognizers,r=W(t,e);r!==-1&&(t.splice(r,1),this.touchAction.update())}return this},on:function(e,t){if(e!==o&&t!==o){var r=this.handlers;return D(se(e),function(i){r[i]=r[i]||[],r[i].push(t)}),this}},off:function(e,t){if(e!==o){var r=this.handlers;return D(se(e),function(i){t?r[i]&&r[i].splice(W(r[i],t),1):delete r[i]}),this}},emit:function(e,t){this.options.domEvents&&jt(e,t);var r=this.handlers[e]&&this.handlers[e].slice();if(!(!r||!r.length)){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var i=0;i<r.length;)r[i](t),i++}},destroy:function(){this.element&&ct(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function ct(e,t){var r=e.element;if(r.style){var i;D(e.options.cssProps,function(n,a){i=oe(r.style,a),t?(e.oldCssProps[i]=r.style[i],r.style[i]=n):r.style[i]=e.oldCssProps[i]||""}),t||(e.oldCssProps={})}}function jt(e,t){var r=c.createEvent("Event");r.initEvent(e,!0,!0),r.gesture=t,t.target.dispatchEvent(r)}x(U,{INPUT_START:E,INPUT_MOVE:k,INPUT_END:v,INPUT_CANCEL:I,STATE_POSSIBLE:ve,STATE_BEGAN:N,STATE_CHANGED:G,STATE_ENDED:X,STATE_RECOGNIZED:q,STATE_CANCELLED:te,STATE_FAILED:b,DIRECTION_NONE:ce,DIRECTION_LEFT:j,DIRECTION_RIGHT:J,DIRECTION_UP:Q,DIRECTION_DOWN:K,DIRECTION_HORIZONTAL:M,DIRECTION_VERTICAL:F,DIRECTION_ALL:Ve,Manager:we,Input:O,TouchAction:Re,TouchInput:fe,MouseInput:ue,PointerEventInput:Se,TouchMouseInput:Oe,SingleTouchInput:Ke,Recognizer:L,AttrRecognizer:A,Tap:ge,Pan:me,Swipe:be,Pinch:Ae,Rotate:Me,Press:xe,on:ie,off:ne,each:D,merge:pt,extend:Xe,assign:x,inherit:P,bindFn:Ie,prefixed:oe});var Jt=typeof s<"u"?s:typeof self<"u"?self:{};Jt.Hammer=U,typeof o=="function"&&o.amd?o(function(){return U}):h.exports?h.exports=U:s[f]=U})(window,document,"Hammer")})(ut);var rr=ut.exports;const ir=tr(rr),ft="/vanilla-tetris/assets/fullscreen-99ccba28.svg",nr="/vanilla-tetris/assets/exit-fullscreen-c3fba1ae.svg",dt=document.getElementById("root"),re=document.createElement("button"),lt=document.getElementById("start-button"),sr=document.getElementById("game-canvas"),vt=new ir(sr),p=new er,Te=document.createElement("img");Te.src=ft;re.id="fullscreen-button";re.className="fullscreen-button";re.appendChild(Te);dt.appendChild(re);lt.addEventListener("click",h=>{h.preventDefault(),h.stopPropagation(),lt.style.display="none",p.start()});re.addEventListener("click",h=>{h.preventDefault(),console.log(h.target),h.stopPropagation(),document.fullscreenElement?document.exitFullscreen&&(document.exitFullscreen(),Te.src=ft):(dt.requestFullscreen(),Te.src=nr)});vt.on("swipe",h=>{h.deltaX<0&&(p==null||p.handleLeftMovement()),h.deltaX>0&&(p==null||p.handleRightMovement())});vt.on("tap",h=>{p==null||p.handleRotationMovement()});window.addEventListener("keydown",h=>{h.key==="ArrowLeft"&&(p==null||p.handleLeftMovement()),h.key==="ArrowRight"&&(p==null||p.handleRightMovement()),h.key==="ArrowUp"&&(p==null||p.handleRotationMovement())});
